{"version":3,"sources":["../src/toolHelper.js"],"names":["params","form","document","querySelector","action","subquestionIdInput","createElement","name","type","value","explorationIdInput","firstElementChild","appendChild","buttonarr","getElementById","window","console","error","buttonsContainer","children","newButton","cloneNode","id","insertBefore","appendLinkToRedactForm","handleReactButton","generateButtons","querySelectorAll","forEach","button","i","addEventListener","select","activityType","options","selectedIndex","text","toLowerCase","courseId","getAttribute","explorationId","explorationIdHolder","subquestionId","location","href","indexOf","substring","url","assign","explorationToolsLink","explorationToolLink","toolIndex","slice","lastIndexOf","urlDisplayer","style","currentButton","disabled","linkContainer","setAttribute"],"mappings":"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","sourcesContent":["import {addIssueNotification} from \"./notificationHelper\";\n\n/**\n * @param {array} params\n */\nexport function initEditTools(params) {\n    let form = document.querySelector('[action^=\"modedit.php\"]');\n    form.action = \"udeh_modedit.php\";\n    let subquestionIdInput = document.createElement('input');\n    subquestionIdInput.name = 'subquestionid';\n    subquestionIdInput.type = 'hidden';\n    subquestionIdInput.value = params[0];\n    let explorationIdInput = document.createElement('input');\n    explorationIdInput.name = 'explorationid';\n    explorationIdInput.type = 'hidden';\n    explorationIdInput.value = params[1];\n    form.firstElementChild.appendChild(subquestionIdInput);\n    form.firstElementChild.appendChild(explorationIdInput);\n    let buttonarr = document.getElementById('fgroup_id_buttonar');\n    if (buttonarr === null) {\n        window.console.error('Back button to redact couldn\\'t be appended. Contact a programmer.');\n    } else {\n        let buttonsContainer = buttonarr.children[1].children[0].children[1];\n        let newButton = buttonsContainer.children[1].cloneNode(true);\n        newButton.children[0].children[0].name = 'submitbutton3';\n        newButton.children[0].children[0].id = 'id_submitbutton3';\n        newButton.children[0].children[0].value = 'Save and return to redact';\n        newButton.children[1].id = 'id_error_submitbutton3';\n        buttonsContainer.insertBefore(newButton, buttonsContainer.children[2]);\n    }\n}\n\n/**\n *\n */\nexport function initRedactTools() {\n    appendLinkToRedactForm();\n    handleReactButton();\n}\n\n/**\n *\n */\nfunction handleReactButton() {\n    let generateButtons = document.querySelectorAll('[id*=\"_generate_tool\"][type=\"button\"]');\n    generateButtons.forEach(function(button, i) {\n        button.addEventListener('click', () => {\n            let select = document.getElementById('id_tool_group_' + i + '_exploration_tool');\n            let activityType = select.options[select.selectedIndex].text.toLowerCase();\n            let courseId = button.getAttribute('courseid');\n            let explorationId = null;\n            let explorationIdHolder = document.querySelector('[name=\"exploration_id[' + i + ']\"]');\n            if (explorationIdHolder === null || explorationIdHolder.value === \"0\") {\n                addIssueNotification('Vous devez enregistrÃ© l\\'exploration avant d\\'y associer un outil');\n                return;\n            } else {\n                explorationId = explorationIdHolder.value;\n            }\n            let subquestionId = null;\n            if (window.location.href.indexOf('=') === -1) {\n                subquestionId = 0;\n            } else {\n                subquestionId = window.location.href.substring(window.location.href.indexOf('=') + 1);\n            }\n            let url = window.location.href.substring(0, window.location.href.indexOf('redact'));\n            url = url + 'udeh_modedit.php?add=' + activityType + '&type=&course=' + courseId +\n                '&section=0&return=0&sr=&subquestionid=' + subquestionId + '&explorationid=' + explorationId;\n            window.location.assign(url);\n        });\n    });\n}\n\n/**\n *\n */\nfunction appendLinkToRedactForm() {\n    let explorationToolsLink = document.querySelectorAll('[name^=\"exploration_tool_cmid[\"]');\n    explorationToolsLink.forEach(explorationToolLink => {\n        let toolIndex = explorationToolLink.name.slice(explorationToolLink.name.indexOf('[') + 1,\n            explorationToolLink.name.lastIndexOf(']'));\n        let urlDisplayer = document.getElementById('fitem_id_exploration_tool_url_display_' + toolIndex);\n\n        let subquestionId = null;\n        if (window.location.href.indexOf('=') === -1) {\n            subquestionId = 0;\n        } else {\n            subquestionId = window.location.href.substring(window.location.href.indexOf('=') + 1);\n        }\n        let explorationId = null;\n        let explorationIdHolder = document.querySelector('[name=\"exploration_id[' + toolIndex + ']\"]');\n        if (explorationIdHolder === null\n            || explorationIdHolder.value === \"0\"\n            || explorationToolLink.value === null\n            || explorationToolLink.value === '') {\n            urlDisplayer.style = \"display:none;\";\n            return;\n        } else {\n            let currentButton = document.getElementById('id_tool_group_' + toolIndex + '_generate_tool');\n            currentButton.disabled = true;\n            explorationId = explorationIdHolder.value;\n        }\n\n        let linkContainer = document.createElement('a');\n        let url = window.location.href.substring(0, window.location.href.indexOf('redact'));\n        url = url + 'udeh_modedit.php?update=' + explorationToolLink.value + '&return=0&sr0=&subquestionid='\n            + subquestionId + '&explorationid=' + explorationId;\n        linkContainer.setAttribute('href', url);\n        linkContainer.appendChild(urlDisplayer.children[1]);\n\n        urlDisplayer.appendChild(linkContainer);\n    });\n}"],"file":"toolHelper.min.js"}