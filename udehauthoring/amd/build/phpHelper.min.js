define ("format_udehauthoring/phpHelper",["exports","./utils","./toolHelper","./language/format_udehauthoring_fr"],function(a,b,c,d){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=function(a){var c=JSON.parse(a);h(c.type);i(c.courseId,c.sectionId,c.subQuestionId,c.type);j();k();(0,b.formatEditorAndFileManager)();(0,b.getAndSetScrollPosition)();(0,b.appendSizeToFileManager)()};function e(a){if("undefined"==typeof Symbol||null==a[Symbol.iterator]){if(Array.isArray(a)||(a=f(a))){var b=0,c=function(){};return{s:c,n:function n(){if(b>=a.length)return{done:!0};return{done:!1,value:a[b++]}},e:function e(a){throw a},f:c}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,e=!0,g=!1,h;return{s:function s(){d=a[Symbol.iterator]()},n:function n(){var a=d.next();e=a.done;return a},e:function e(a){g=!0;h=a},f:function f(){try{if(!e&&null!=d.return)d.return()}finally{if(g)throw h}}}}function f(a,b){if(!a)return;if("string"==typeof a)return g(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return g(a,b)}function g(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}var p=0,q=null,r=null,s=null;function h(a){if(0===a){r=d.dictionnary.module;s=[d.dictionnary.trame]}else{r=d.dictionnary.trame;s=[d.dictionnary.activity,d.dictionnary.resource]}}function i(a,b,d,e){if(0===e){window.$.ajax({type:"POST",url:"../handlers/ajax_module_handler.php",data:{courseId:a},success:function success(a){var c=JSON.parse(a);c.data.forEach(function(a,c){if(parseInt(a.id)===b){q=a;p=c}});m();s.forEach(function(a){n(a)})},error:function error(){window.console.log("failure")}})}else{window.$.ajax({type:"POST",url:"../handlers/ajax_subquestion_handler.php",data:{sectionId:b,courseId:a},success:function success(a){var b=JSON.parse(a);b.data.forEach(function(a,b){if(parseInt(a.id)===d){q=a;p=b}});m();s.forEach(function(a){n(a,b.index)})},error:function error(){window.console.log("failure")}});(0,c.initRedactTools)()}}function j(){var a=document.querySelectorAll("[name^=\"add\"]");a.forEach(function(a,b){if("submit"===a.getAttribute("type")){var c=document.querySelectorAll(".add_action_button"),d=document.createElement("i"),e=l(a,"button");e.setAttribute("class","btn add-button");d.setAttribute("class","fa fa-plus-circle fa-2x");e.appendChild(d);c[b].appendChild(e);a.hidden=!0}})}function k(){var a=document.querySelectorAll("[name^=\"remove_\"]");a.forEach(function(a){if("submit"===a.getAttribute("type")){var b=document.createElement("i"),c=l(a,"button");c.setAttribute("class","btn remove-button");b.setAttribute("class","fa fa-minus-circle fa-2x");c.appendChild(b);a.parentElement.appendChild(c);a.parentElement.classList.add("remove_action_button");a.hidden=!0}})}function l(a,b){var c=document.createElement(b),d=a.cloneNode(!0);while(d.firstChild){c.appendChild(d.firstChild)}var f=e(d.attributes),g;try{for(f.s();!(g=f.n()).done;){var h=g.value;c.setAttribute(h.name,h.value)}}catch(a){f.e(a)}finally{f.f()}return c}function m(){var a=document.querySelector("[id*=\"preview_header\"]");a.firstElementChild.innerHTML=r+(p+1)+" - "+(0,b.removeTags)(q.title)}function n(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:null,c=null,e=null,f=null;if(a===d.dictionnary.trame){c=document.querySelectorAll("[class*=\"row_section_subquestion_container\"]");e="SectionSubQuestion_";f="subquestion"}else if(a===d.dictionnary.resource){c=document.querySelectorAll("[class*=\"row_subquestion_resource_container\"]");e="SubQuestionResource_";f="resource"}else if(a===d.dictionnary.activity){c=document.querySelectorAll("[class*=\"row_subquestion_exploration_container\"]");e="SubQuestionExploration_";f="exploration"}c.forEach(function(b,c){var f=b.querySelector("[class*=\"accordion-container\"]"),g=f.firstElementChild.firstElementChild;g.href="#collapse"+e+c;g.setAttribute("aria-controls","collapse"+e+c);f.children[1].setAttribute("id","collapse"+e+c);if(0<c){f.children[1].setAttribute("class","collapse");g.setAttribute("aria-expanded","false");g.setAttribute("class","collapsed")}if(a===d.dictionnary.trame){o(g,a,c,q.subquestions)}else if(a===d.dictionnary.resource){o(g,a,c,q.resources)}else if(a===d.dictionnary.activity){o(g,a,c,q.explorations,!1)}});var g=document.getElementById("add_"+f+"_container");if(a===d.dictionnary.trame){g.firstElementChild.firstElementChild.innerHTML=a+" "+(p+1)+"."+(c.length+1)}else{g.firstElementChild.firstElementChild.innerHTML=a+" "+(b+1)+"."+(p+1)+"."+(c.length+1)}}function o(a,c,d,e){var f=4<arguments.length&&arguments[4]!==void 0?arguments[4]:!0;if(e&&e[d]){var g=e[d].title,h="";if(f){h=c+(p+1)+"."+(d+1)+" - "+(0,b.removeTags)(g)}else{h=c+(p+1)+"."+(d+1)}a.innerHTML=70<h.length?h.substring(0,70)+"...":h}else{a.innerHTML=c+(p+1)+"."+(d+1)}}});
//# sourceMappingURL=phpHelper.min.js.map
