define ("format_udehauthoring/phpHelper",["exports","./utils","./language/format_udehauthoring_fr"],function(a,b,c){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.initGlobalEvaluations=function(a){var c=JSON.parse(a),d=document.getElementById("id_add_global_evaluation");d.hidden=!0;var e=document.querySelectorAll("[class*=\"single-accordion-container\"]");e.forEach(function(a,d){var e=a.firstElementChild.firstElementChild;e.href="#collapseGlobalEvaluation"+d;e.setAttribute("aria-controls","collapseGlobalEvaluation"+d);a.children[1].setAttribute("id","collapseGlobalEvaluation"+d);if(0<d){a.children[1].setAttribute("class","collapse");e.setAttribute("aria-expanded","false");e.setAttribute("class","collapsed")}if(c[d]){var f=c[d],g="Evaluation Globale "+(d+1)+" - "+(0,b.removeTags)(f);e.innerHTML=70<g.length?g.substring(0,70)+"...":g}else{e.innerHTML="Evaluation Globale "+(d+1)}});(0,b.formatEditorAndFileManager)()};a.init=function(a){var c=JSON.parse(a);g(c.type);h(c.courseId,c.sectionId,c.subQuestionId,c.type);i();j();(0,b.formatEditorAndFileManager)()};function d(a){if("undefined"==typeof Symbol||null==a[Symbol.iterator]){if(Array.isArray(a)||(a=e(a))){var b=0,c=function(){};return{s:c,n:function n(){if(b>=a.length)return{done:!0};return{done:!1,value:a[b++]}},e:function e(a){throw a},f:c}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,f=!0,g=!1,h;return{s:function s(){d=a[Symbol.iterator]()},n:function n(){var a=d.next();f=a.done;return a},e:function e(a){g=!0;h=a},f:function f(){try{if(!f&&null!=d.return)d.return()}finally{if(g)throw h}}}}function e(a,b){if(!a)return;if("string"==typeof a)return f(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return f(a,b)}function f(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}var o=0,p=null,q=null,r=null;function g(a){if(0===a){q=c.dictionnary.module;r=[c.dictionnary.trame]}else{q=c.dictionnary.trame;r=[c.dictionnary.activity,c.dictionnary.resource]}}function h(a,b,c,d){if(0===d){window.$.ajax({type:"POST",url:"../handlers/ajax_module_handler.php",data:{courseId:a},success:function success(a){var c=JSON.parse(a);c.data.forEach(function(a,c){if(parseInt(a.id)===b){p=a;o=c}});l();r.forEach(function(a){m(a)})},error:function error(){window.console.log("failure")}})}else{window.$.ajax({type:"POST",url:"../handlers/ajax_subquestion_handler.php",data:{sectionId:b,courseId:a},success:function success(a){var b=JSON.parse(a);b.data.forEach(function(a,b){if(parseInt(a.id)===c){p=a;o=b}});l();r.forEach(function(a){m(a,b.index)})},error:function error(){window.console.log("failure")}})}}function i(){var a=document.querySelectorAll("[name^=\"add\"]");a.forEach(function(a,b){if("submit"===a.getAttribute("type")){var c=document.querySelectorAll(".add_action_button"),d=document.createElement("i"),e=k(a,"button");e.setAttribute("class","btn add-button");d.setAttribute("class","fa fa-plus-circle fa-2x");e.appendChild(d);c[b].appendChild(e);a.hidden=!0}})}function j(){var a=document.querySelectorAll("[name^=\"remove_\"]");a.forEach(function(a){if("submit"===a.getAttribute("type")){var b=document.createElement("i"),c=k(a,"button");c.setAttribute("class","btn remove-button");b.setAttribute("class","fa fa-minus-circle fa-2x");c.appendChild(b);a.parentElement.appendChild(c);a.parentElement.classList.add("remove_action_button");a.hidden=!0}})}function k(a,b){var c=document.createElement(b),e=a.cloneNode(!0);while(e.firstChild){c.appendChild(e.firstChild)}var f=d(e.attributes),g;try{for(f.s();!(g=f.n()).done;){var h=g.value;c.setAttribute(h.name,h.value)}}catch(a){f.e(a)}finally{f.f()}return c}function l(){var a=document.querySelector("[id*=\"preview_header\"]");a.firstElementChild.innerHTML=q+(o+1)+" - "+(0,b.removeTags)(p.title)}function m(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:null,d=null,e=null,f=null;if(a===c.dictionnary.trame){d=document.querySelectorAll("[class*=\"row_section_subquestion_container\"]");e="SectionSubQuestion_";f="subquestion"}else if(a===c.dictionnary.resource){d=document.querySelectorAll("[class*=\"row_subquestion_resource_container\"]");e="SubQuestionResource_";f="resource"}else if(a===c.dictionnary.activity){d=document.querySelectorAll("[class*=\"row_subquestion_exploration_container\"]");e="SubQuestionExploration_";f="exploration"}d.forEach(function(b,d){var f=b.querySelector("[class*=\"accordion-container\"]"),g=f.firstElementChild.firstElementChild;g.href="#collapse"+e+d;g.setAttribute("aria-controls","collapse"+e+d);f.children[1].setAttribute("id","collapse"+e+d);if(0<d){f.children[1].setAttribute("class","collapse");g.setAttribute("aria-expanded","false");g.setAttribute("class","collapsed")}if(a===c.dictionnary.trame){n(g,a,d,p.subquestions)}else if(a===c.dictionnary.resource){n(g,a,d,p.resources)}else if(a===c.dictionnary.activity){n(g,a,d,p.explorations,!1)}});var g=document.getElementById("add_"+f+"_container");if(a===c.dictionnary.trame){g.firstElementChild.firstElementChild.innerHTML=a+" "+(o+1)+"."+(d.length+1)}else{g.firstElementChild.firstElementChild.innerHTML=a+" "+(b+1)+"."+(o+1)+"."+(d.length+1)}}function n(a,c,d,e){var f=4<arguments.length&&arguments[4]!==void 0?arguments[4]:!0;if(e&&e[d]){var g=e[d].title,h="";if(f){h=c+(o+1)+"."+(d+1)+" - "+(0,b.removeTags)(g)}else{h=c+(o+1)+"."+(d+1)}a.innerHTML=70<h.length?h.substring(0,70)+"...":h}else{a.innerHTML=c+(o+1)+"."+(d+1)}}});
//# sourceMappingURL=phpHelper.min.js.map
