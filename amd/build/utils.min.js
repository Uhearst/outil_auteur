define("format_udehauthoring/utils",["exports","./language/format_udehauthoring_fr"],(function(_exports,_format_udehauthoring_fr){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.appendAnchorToForm=function(anchor){var anchorInput=document.getElementById("anchor");if(null===anchorInput){var input=document.createElement("input");input.setAttribute("type","hidden"),input.setAttribute("name","anchor"),input.setAttribute("id","anchor"),input.setAttribute("value",anchor),document.getElementById("form_container").appendChild(input)}else anchorInput.setAttribute("value",anchor)},_exports.appendSizeToFileManager=function(){var fileManagers=document.querySelectorAll('[id*="vignette"]');fileManagers&&fileManagers.forEach((function(fileManager){if(fileManager.classList.contains("form-group")){var valueForFormat="";valueForFormat=fileManager.getAttribute("id").includes("resource")?"125 x 80":"364 x 215";var restrictions=fileManager.querySelector(".fp-restrictions");restrictions.firstElementChild.innerHTML=restrictions.firstElementChild.innerHTML+", "+_format_udehauthoring_fr.dictionnary.recommendedFormat+valueForFormat}}))},_exports.appendStyleToAnchorMenuSection=function(id){for(var container=document.getElementById("collapse-course-container"),i=0;i<container.children.length;i++)container.children[i].getAttribute("class").includes("disabled-menu-element")||(container.children[i].setAttribute("class","mb-3"),updateIcon(container.children[i],"actif","passif"));var element=document.getElementById(id);element.classList.add("active-menu-element"),updateIcon(element,"passif","actif",!0)},_exports.formatEditorAndFileManager=function(){document.getElementById("udeh-form").querySelectorAll('[class^="form-group row  fitem   "]').forEach((function(input){input.children[1]&&input.children[1].dataset&&("editor"===input.children[1].dataset.fieldtype||"filemanager"===input.children[1].dataset.fieldtype)&&(input.classList.add("inline-element"),input.children[1].classList.add("inline-inner-element"))}))},_exports.getAndSetScrollPosition=function(){var addedType=localStorage.getItem("added-type");null!==addedType&&"null"!==addedType&&void 0!==addedType&&("loading"!==document.readyState?toggleAccordionFromPhpAddition(addedType):document.addEventListener("DOMContentLoaded",(function(){toggleAccordionFromPhpAddition(addedType)})));window.addEventListener("beforeunload",(function(){document.activeElement&&document.activeElement.classList&&document.activeElement.classList.contains("add-button")?localStorage.setItem("added-type",document.activeElement.name.substring(document.activeElement.name.indexOf("_1"))):localStorage.setItem("added-type",null)}))},_exports.handleEmbed=function(embedContainerId,introductionContainerId){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,customCheckbox=null,embedValContainer=null;null!==i?(customCheckbox=document.getElementById("embed_selector_"+i),embedValContainer=document.querySelector('[name="isembed['+i+']"]')):(customCheckbox=document.getElementById("embed_selector"),embedValContainer=document.querySelector('[name="isembed"]'));"1"===embedValContainer.value&&(customCheckbox.checked=!0);setEmbedVisible(customCheckbox,embedContainerId,introductionContainerId),customCheckbox.addEventListener("click",(function(){setEmbedVisible(customCheckbox,embedContainerId,introductionContainerId)}))},_exports.handleNewAccordionElement=handleNewAccordionElement,_exports.initTinyMce=function(id,toolBarOptions){window.tinymce.init({selector:"textarea#"+id,menubar:!1,plugins:"lists image table link charmap emoticons",toolbar:toolBarOptions,branding:!1,min_height:160,height:160})},_exports.prepareAccordions=function(currentIdContainer){var isObj=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,elements=null;elements=1===isObj?document.querySelectorAll('[class="row row-container mb-3"]'):2===isObj?document.querySelectorAll('[class="row row-container-child mb-3"]'):document.querySelectorAll("[id^="+currentIdContainer+"]");elements.forEach((function(element){window.$(document).ready((function(){window.$("#"+element.firstElementChild.children[1].id).on("shown.bs.collapse",(function(event){event.stopPropagation();var $card=window.$(this).closest(".card");window.$("html,body").animate({scrollTop:$card.offset().top-100},250)}))}))}))},_exports.prepareActionButton=function(buttons){var addingButtonsContainer=document.querySelectorAll("[class='col-md-9 form-inline align-items-start felement']");addingButtonsContainer&&addingButtonsContainer.forEach((function(addingButtonContainer){"button"===addingButtonContainer.dataset.fieldtype&&(addingButtonContainer.removeAttribute("class"),addingButtonContainer.childNodes.forEach((function(child){child.type&&"button"===child.type&&child.classList.remove("btn-secondary")})))}));var addingButtons=document.querySelectorAll("[class*='add_action_button']");addingButtons&&addingButtons.forEach((function(addingButton){addingButton.childNodes.forEach((function(child){child.removeAttribute("class")}))}));buttons.forEach((function(button){if(0===button.type){var initialRemoveButton=document.getElementById("fitem_id_remove_"+button.id);initialRemoveButton&&initialRemoveButton.firstElementChild.style.setProperty("display","none","important")}else{var _initialRemoveButton=document.getElementById("fitem_id_add_"+button.id);_initialRemoveButton&&_initialRemoveButton.firstElementChild.style.setProperty("display","none","important")}}))},_exports.removeTags=function(str){if(null===str||""===str)return!1;str=str.toString();return str.replace(/(<([^>]+)>)/gi,"")},_exports.removeTinyMce=function(id){window.tinymce.remove("#"+id)};var tryCounter=0;function handleNewAccordionElement(element){tryCounter+=1,window.$(document).ready((function(){var collapsibleId=element.firstElementChild.children[1].getAttribute("id");try{window.$("#"+collapsibleId).collapse("toggle"),window.$("#"+collapsibleId).on("shown.bs.collapse",(function(){var $card=window.$(this).closest(".card");window.$("html,body").animate({scrollTop:$card.offset().top-100},250)}))}catch(e){if(tryCounter>20)window.console.error("New accordeons can't be handled, contact a dev."),window.console.error("Error detail: "+e);else{window.console.log("got error handling new accordeon, will retry");var interval=setInterval((function(){handleNewAccordionElement(element),clearInterval(interval)}),100)}}}))}function toggleAccordionFromPhpAddition(addedType){var rows,currentElement,interval,container=null,forId=null;addedType.includes("subquestion")?container=document.getElementById("section-subquestions-container"):(forId=addedType.includes("resource")?"resources":"explorations",container=document.getElementById("subquestion-"+forId+"-container")),rows=container.querySelectorAll('[class*="row-container"]'),currentElement=rows[rows.length-1],interval=setInterval((function(){currentElement.firstElementChild.children[1].getAttribute("id").includes("_")&&(handleNewAccordionElement(currentElement),clearInterval(interval))}),100)}function updateIcon(element,previousValue,newValue){var isActive=arguments.length>3&&void 0!==arguments[3]&&arguments[3],src=element.firstElementChild.firstElementChild.getAttribute("src");if(src&&src.includes(previousValue)){var newSrc=src.replace(previousValue,newValue);element.firstElementChild.firstElementChild.setAttribute("src",newSrc),element.setAttribute("onmouseout",'this.firstElementChild.firstElementChild.setAttribute("src", "'+newSrc+'")')}isActive?element.firstElementChild.setAttribute("class","active"):element.firstElementChild.removeAttribute("class")}function setEmbedVisible(customCheckbox,embedContainerId,introductionContainerId){var embedContainer=document.getElementById(embedContainerId),introductionContainer=document.getElementById(introductionContainerId);customCheckbox.checked?(embedContainer.style="",introductionContainer.style="display:none !important"):(embedContainer.style="display:none !important",introductionContainer.style="")}}));

//# sourceMappingURL=utils.min.js.map