define("format_udehauthoring/accordionHandler",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.initAccordionsAfterFillingForm=_exports.handleNewAccordion=_exports.handleAccordions=void 0;const getCollapsibles=anchor=>{let collapsibles=document.querySelector("#"+anchor).querySelectorAll('[data-toggle="collapse"]');return Array.from(collapsibles).filter((collapsible=>collapsible.getAttribute("aria-controls").includes("collapse")))},getAnchor=()=>{let anchors=window.location.href.includes("#")?[window.location.href.substring(window.location.href.lastIndexOf("#")+1)]:[""];return window.$("#global-evaluations-container").length>0&&(anchors=["global-evaluations-container"]),window.$("#section-subquestions-container").length>0&&(anchors=["section-subquestions-container"]),window.$("#subquestion-explorations-container").length>0&&(anchors=["subquestion-explorations-container","subquestion-resources-container"]),anchors},clickAndRetry=function(collapsibleHeader){let state=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],interval=setInterval((function(){state?collapsibleHeader.classList&&collapsibleHeader.classList.contains("collapsed")?collapsibleHeader.click():clearInterval(interval):collapsibleHeader.classList&&!collapsibleHeader.classList.contains("collapsed")?collapsibleHeader.click():clearInterval(interval)}),100)},handleAccordion=function(collapsible,anchor){let forceOpen=arguments.length>2&&void 0!==arguments[2]&&arguments[2],withNavigation=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];forceOpen&&clickAndRetry(collapsible),collapsible.addEventListener("click",(function(){const myCollapseEl=document.querySelector("#"+collapsible.getAttribute("aria-controls"));if(anchor.includes("objectives")?(localStorage.removeItem("focusOn_"+anchor+"-learning"),myCollapseEl.id.includes("learning")||localStorage.removeItem("focusOn_"+anchor)):localStorage.removeItem("focusOn_"+anchor),"false"===collapsible.getAttribute("aria-expanded")){if(myCollapseEl.id.includes("learning")){let parent=myCollapseEl.closest('[id^="course_learning_objectives_container_"]'),index=parent.id.substring(parent.id.lastIndexOf("_")+1,parent.id.length);localStorage.setItem("focusOn_"+anchor,"collapse_teaching_"+index),localStorage.setItem("focusOn_"+anchor+"-learning",myCollapseEl.id)}else if(localStorage.setItem("focusOn_"+anchor,myCollapseEl.id),myCollapseEl.id.includes("teaching")&&null===localStorage.getItem("focusOn_"+anchor+"-learning")){let selector="collapse_learning_"+myCollapseEl.id.substring(myCollapseEl.id.lastIndexOf("_")+1)+"_0";document.querySelector('[aria-controls="'+selector+'"]').classList.contains("collapsed")&&clickAndRetry(document.querySelector('[aria-controls="'+selector+'"]')),localStorage.setItem("focusOn_"+anchor+"-learning",selector)}if(withNavigation){let $card=window.$(this).closest(".card");window.$("html,body").animate({scrollTop:$card.offset().top-100},250)}}}))};_exports.initAccordionsAfterFillingForm=()=>{window.$(document).ready((function(){getAnchor().forEach((anchor=>{let collapsibleId=localStorage.getItem("focusOn_"+anchor),elm=document.querySelector('[aria-controls="'+collapsibleId+'"]');if(collapsibleId&&elm){clickAndRetry(elm);let subCollapsibleId=localStorage.getItem("focusOn_"+anchor+"-learning"),subElm=document.querySelector('[aria-controls="'+subCollapsibleId+'"]');subCollapsibleId&&subElm&&clickAndRetry(subElm)}else{let firstCollapsibleHeader=getCollapsibles(anchor)[0];clickAndRetry(firstCollapsibleHeader),"displayable-form-objectives-container"===anchor&&clickAndRetry(getCollapsibles(anchor)[1])}}))}))};_exports.handleAccordions=function(){let withNavigation=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];window.$(document).ready((function(){getAnchor().forEach((anchor=>{let collapsibles=getCollapsibles(anchor);for(const collapsible of collapsibles)1===collapsibles.length||2===collapsibles.length&&"collapse_teaching_0"===collapsibles[0].getAttribute("aria-controls")?handleAccordion(collapsible,anchor,!0,withNavigation):handleAccordion(collapsible,anchor,!1,withNavigation)}))}))};_exports.handleNewAccordion=(prefix,counter)=>{let anchor=getAnchor();document.querySelectorAll('[id^="'+prefix.replace("#","")+'"]').forEach((header=>{let collapsibleHeader=header.querySelector("a");clickAndRetry(collapsibleHeader,!1)}));let collapsibleHeader=document.querySelector(prefix+counter+" a");handleAccordion(collapsibleHeader,anchor,!0)}}));

//# sourceMappingURL=accordionHandler.min.js.map