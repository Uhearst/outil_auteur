define("format_udehauthoring/toolHelper",["exports","core/str","./notificationHelper"],(function(_exports,_str,_notificationHelper){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.initEditTools=function(params){let form=document.querySelector('[action^="modedit.php"]');form.action="udeh_modedit.php";let subquestionIdInput=document.createElement("input");subquestionIdInput.name="subquestionid",subquestionIdInput.type="hidden",subquestionIdInput.value=params[0];let explorationIdInput=document.createElement("input");explorationIdInput.name="explorationid",explorationIdInput.type="hidden",explorationIdInput.value=params[1];let evaluationIdInput=document.createElement("input");evaluationIdInput.name="evaluationid",evaluationIdInput.type="hidden",evaluationIdInput.value=params[2];let isglobalInput=document.createElement("input");isglobalInput.name="isglobal",isglobalInput.type="hidden",isglobalInput.value=params[3],form.firstElementChild.appendChild(subquestionIdInput),form.firstElementChild.appendChild(explorationIdInput),form.firstElementChild.appendChild(evaluationIdInput),form.firstElementChild.appendChild(isglobalInput);let buttonarr=document.getElementById("fgroup_id_buttonar");if(null===buttonarr)window.console.error("Back button to redact couldn't be appended. Contact a programmer.");else{let buttonsContainer=buttonarr.children[1].children[0].children[0],newButton=buttonsContainer.children[1].cloneNode(!0);newButton.children[0].children[0].name="submitbutton3",newButton.children[0].children[0].id="id_submitbutton3",(0,_str.get_string)("saveandreturntoredact","format_udehauthoring").then((valueString=>{newButton.children[0].children[0].value=valueString})).catch((()=>{newButton.children[0].children[0].value="Enregistrer et retourner à la rédaction"})),newButton.children[1].id="id_error_submitbutton3",buttonsContainer.insertBefore(newButton,buttonsContainer.children[2])}},_exports.initRedactTools=function(type,toolList){1===type?function(toolList){document.querySelectorAll('[name^="exploration_tool_cmid["]').forEach((explorationToolLink=>{let toolIndex=explorationToolLink.name.slice(explorationToolLink.name.indexOf("[")+1,explorationToolLink.name.lastIndexOf("]")),urlDisplayer=document.getElementById("fgroup_id_url_group_"+toolIndex);if(""===toolList[toolIndex]||null===toolList[toolIndex]||void 0===toolList[toolIndex])return void(urlDisplayer.style="display:none;");let subquestionId=null;subquestionId=-1===window.location.href.indexOf("=")?0:window.location.href.substring(window.location.href.indexOf("=")+1);let explorationId=null,explorationIdHolder=document.querySelector('[name="exploration_id['+toolIndex+']"]');if(null===explorationIdHolder||"0"===explorationIdHolder.value||null===explorationToolLink.value||""===explorationToolLink.value)return void(urlDisplayer.style="display:none;");document.getElementById("id_tool_group_"+toolIndex+"_generate_tool").disabled=!0,document.getElementById("id_tool_group_"+toolIndex+"_exploration_tool").disabled=!0,explorationId=explorationIdHolder.value;let container=document.createElement("div");container.setAttribute("class","form-group fitem");let linkContainer=document.createElement("a"),url=window.location.href.substring(0,window.location.href.indexOf("redact"));url=url+"udeh_modedit.php?update="+explorationToolLink.value+"&return=0&sr0=&subquestionid="+subquestionId+"&explorationid="+explorationId,linkContainer.setAttribute("href",url),linkContainer.setAttribute("id","exploration_tool_name_"+toolIndex),linkContainer.innerHTML=toolList[toolIndex],container.appendChild(linkContainer),urlDisplayer.children[1].children[0].children[1].insertBefore(container,urlDisplayer.children[1].children[0].children[1].firstElementChild)}))}(toolList):2===type&&function(toolList){let evaluationToolsLink=document.querySelectorAll('[name^="evaluation_tool_cmid"]');location.href.includes("globalevaluation")?function(evaluationToolsLink,toolList){evaluationToolsLink.forEach((evaluationToolLink=>{let toolIndex=evaluationToolLink.name.slice(evaluationToolLink.name.indexOf("[")+1,evaluationToolLink.name.lastIndexOf("]")),urlDisplayer=document.getElementById("fgroup_id_url_group_"+toolIndex),evaluationId=null,evaluationIdHolder=document.querySelector('[name="evaluation_id['+toolIndex+']"]');if(null===evaluationToolLink.value||""===evaluationToolLink.value||""===toolList[toolIndex])return void(urlDisplayer.style="display:none;");document.getElementById("id_tool_group_"+toolIndex+"_generate_tool").disabled=!0,document.getElementById("id_tool_group_"+toolIndex+"_evaluation_tool").disabled=!0,evaluationId=evaluationIdHolder.value;let container=document.createElement("div");container.setAttribute("class","form-group fitem");let linkContainer=document.createElement("a"),url=window.location.href.substring(0,window.location.href.indexOf("redact"));url=url+"udeh_modedit.php?update="+evaluationToolLink.value+"&return=0&sr0=&evaluationid="+evaluationId+"&isglobal=1",linkContainer.setAttribute("href",url),linkContainer.setAttribute("id","evaluation_tool_name_"+toolIndex),linkContainer.innerHTML=toolList[toolIndex],container.appendChild(linkContainer),urlDisplayer.children[1].children[0].children[1].insertBefore(container,urlDisplayer.children[1].children[0].children[1].firstElementChild)}))}(evaluationToolsLink,toolList):function(evalName){let evaluationToolLink=document.querySelector('[name^="evaluation_tool_cmid"]'),urlDisplayer=document.getElementById("fgroup_id_url_group"),evaluationId=null,evaluationIdHolder=document.querySelector('[name="id"]');if(null===evaluationToolLink.value||""===evaluationToolLink.value||""===evalName)return void(urlDisplayer.style="display:none;");document.getElementById("id_generate_tool").disabled=!0,document.getElementById("id_evaluation_tool").disabled=!0,evaluationId=evaluationIdHolder.value;let container=document.createElement("div");container.setAttribute("class","form-group fitem");let linkContainer=document.createElement("a"),url=window.location.href.substring(0,window.location.href.indexOf("redact"));url=url+"udeh_modedit.php?update="+evaluationToolLink.value+"&return=0&sr0=&evaluationid="+evaluationId,linkContainer.setAttribute("href",url),linkContainer.setAttribute("id","evaluation_tool_name"),linkContainer.innerHTML=evalName,container.appendChild(linkContainer),urlDisplayer.children[1].children[0].children[1].insertBefore(container,urlDisplayer.children[1].children[0].children[1].firstElementChild)}(toolList[0])}(toolList);!function(){let inputToAppend=document.createElement("input");document.getElementById("udeh-form").addEventListener("submit",(async function(e){if(e.submitter&&e.submitter.name.includes("generate_tool")){e.preventDefault();let n=window.location.pathname.lastIndexOf("/");if(window.location.pathname.substring(n+1).includes("subquestion")){let index=e.submitter.name.substring(e.submitter.name.indexOf("[")+1,e.submitter.name.indexOf("]")),explorationIdHolder=document.querySelector('[name="exploration_id['+index+']"]');if(null===explorationIdHolder||"0"===explorationIdHolder.value)return void(0,_notificationHelper.addNotification)(await(0,_str.get_string)("notificationerrorsaveexplo","format_udehauthoring"),2)}inputToAppend.type="hidden",inputToAppend.name=e.submitter.name,inputToAppend.value="Generate Tool",window.$("#udeh-form")[0].append(inputToAppend),window.$("#udeh-form").submit()}}))}()}}));

//# sourceMappingURL=toolHelper.min.js.map