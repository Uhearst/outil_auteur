{"version":3,"file":"alertModal.min.js","sources":["../src/alertModal.js"],"sourcesContent":["let currentIndex = null;\nlet currentName = null;\n\n/**\n *\n */\nexport function handleModal() {\n\n    buildModal();\n    toggleModal();\n    deleteToolFromModal();\n}\n\n/**\n *\n */\nfunction buildModal() {\n    let modalContainer = document.createElement('div');\n    let modalDialog = document.createElement('div');\n    let modalContent = document.createElement('div');\n    let modalHeader = document.createElement('div');\n    let modalTitle = document.createElement('h5');\n    let modalBody = document.createElement('div');\n    let modalFooter = document.createElement('div');\n    let buttonClose = document.createElement('button');\n    let buttonCloseHeader = document.createElement('button');\n    let buttonSave = document.createElement('button');\n\n    modalContainer.setAttribute('class', 'modal fade alert-modal');\n    modalContainer.setAttribute('id', 'alertModal');\n    modalContainer.setAttribute('tabindex', '-1');\n    modalContainer.setAttribute('role', 'dialog');\n    modalContainer.setAttribute('aria-labelledby', 'alertModalLabel');\n    modalContainer.setAttribute('aria-hidden', 'true');\n\n    modalDialog.setAttribute('class', 'modal-dialog');\n    modalDialog.setAttribute('role', 'document');\n\n    modalContent.setAttribute('class', 'modal-content alert-modal-content');\n\n    modalHeader.setAttribute('class', 'modal-header');\n\n    modalTitle.setAttribute('class', 'modal-title');\n    modalTitle.setAttribute('id', 'alertModalLabel');\n    modalTitle.innerHTML = 'Supression d\\'élément';\n\n    buttonCloseHeader.setAttribute('type', 'button');\n    buttonCloseHeader.setAttribute('class', 'close');\n    buttonCloseHeader.setAttribute('data-dismiss', 'modal');\n    buttonCloseHeader.setAttribute('aria-label', 'Close');\n    buttonCloseHeader.innerHTML = '<span aria-hidden=\"true\">&times;</span>';\n\n    modalBody.setAttribute('class', 'modal-body');\n    modalBody.innerHTML = 'Êtes-vous sûr ?';\n\n    modalFooter.setAttribute('class', 'modal-footer');\n\n    buttonClose.setAttribute('type', 'button');\n    buttonClose.setAttribute('class', 'btn btn-secondary');\n    buttonClose.setAttribute('data-dismiss', 'modal');\n    buttonClose.innerHTML = 'Annuler';\n\n    buttonSave.setAttribute('type', 'button');\n    buttonSave.setAttribute('class', 'btn btn-primary');\n    buttonSave.setAttribute('id', 'btn_delete_tool');\n    buttonSave.innerHTML = 'Supprimer';\n\n    modalFooter.appendChild(buttonClose);\n    modalFooter.appendChild(buttonSave);\n\n    modalHeader.appendChild(modalTitle);\n    modalHeader.appendChild(buttonCloseHeader);\n\n    modalContent.appendChild(modalHeader);\n    modalContent.appendChild(modalBody);\n    modalContent.appendChild(modalFooter);\n\n    modalDialog.appendChild(modalContent);\n\n    modalContainer.appendChild(modalDialog);\n    let form = document.getElementById('udeh-form');\n    if (form) {\n        form.appendChild(modalContainer);\n    }\n\n\n}\n\n/**\n *\n */\nfunction toggleModal() {\n    let buttons = document.querySelectorAll('[name*=\"[delete_tool]\"]');\n    buttons.forEach(button => {\n        button.addEventListener('click', e => {\n            e.stopImmediatePropagation();\n            window.$('#alertModal').modal('toggle');\n            if (location.href.includes('subquestion') || location.href.includes('globalevaluation')) {\n                currentIndex = button.name.slice(button.name.indexOf('[') + 1,\n                    button.name.indexOf(']'));\n            }\n            if (window.location.pathname.includes('subquestion')) {\n                currentName = document.querySelector('[id = \"exploration_tool_name_' + currentIndex + '\"]').innerHTML;\n            } else {\n                if (currentIndex === null) {\n                    currentName = document.querySelector('[id = \"evaluation_tool_name\"]').innerHTML;\n                } else {\n                    currentName = document.querySelector('[id = \"evaluation_tool_name_' + currentIndex + '\"]').innerHTML;\n                }\n            }\n            let modalBody = document.querySelector('[class = \"modal-body\"]');\n            modalBody.innerHTML = 'Êtes-vous sûr de vouloir supprimer l\\'outil ' + currentName + '?';\n\n        });\n    });\n}\n\n/**\n *\n */\nfunction deleteToolFromModal() {\n    let deleteButton = document.getElementById('btn_delete_tool');\n\n    deleteButton.addEventListener('click', () => {\n        let cmid = null;\n        let id = null;\n        let type = null;\n        if(window.location.pathname.includes('subquestion')) {\n            type = 1;\n            cmid = document.querySelector('[name = \"exploration_tool_cmid[' + currentIndex + ']\"]');\n            id = document.querySelector('[name = \"exploration_id[' + currentIndex + ']\"]');\n        } else {\n            type = 2;\n            if(currentIndex === null) {\n                cmid = document.querySelector('[name = \"evaluation_tool_cmid\"]');\n                id = document.querySelector('[name = \"id\"]');\n            } else {\n                cmid = document.querySelector('[name = \"evaluation_tool_cmid[' + currentIndex + ']\"]');\n                id = document.querySelector('[name = \"evaluation_id[' + currentIndex + ']\"]');\n            }\n        }\n        window.$.ajax(\n            {\n                type: \"POST\",\n                url: \"../handlers/ajax_tool_handler.php\",\n                data: {\n                    cmid: cmid.value,\n                    id: id.value,\n                    type: type,\n                },\n                success: function() {\n                    window.$('#alertModal').modal('toggle');\n                    if (currentIndex === null) {\n                        document.getElementById('fgroup_id_url_group').style = \"display:none;\";\n                        document.querySelector('[name*=\"generate_tool\"]').disabled = false;\n                        let select = document.getElementById('id_evaluation_tool');\n                        select.disabled = false;\n                    } else {\n                        document.getElementById('fgroup_id_url_group_' + currentIndex).style = \"display:none;\";\n                        document.getElementById('id_tool_group_' + currentIndex + '_generate_tool').disabled = false;\n                        if (window.location.pathname.includes('subquestion')) {\n                            document.getElementById('id_tool_group_' + currentIndex + '_exploration_tool').disabled = false;\n                        } else {\n                            document.getElementById('id_tool_group_' + currentIndex + '_evaluation_tool').disabled = false;\n                        }\n\n                    }\n                    currentIndex = null;\n                    window.location.reload();\n                },\n                error: function() {\n                    window.console.log('failure');\n                }\n            });\n    });\n}"],"names":["modalContainer","document","createElement","modalDialog","modalContent","modalHeader","modalTitle","modalBody","modalFooter","buttonClose","buttonCloseHeader","buttonSave","setAttribute","innerHTML","appendChild","form","getElementById","buildModal","querySelectorAll","forEach","button","addEventListener","e","stopImmediatePropagation","window","$","modal","location","href","includes","currentIndex","name","slice","indexOf","currentName","pathname","querySelector","cmid","id","type","ajax","url","data","value","success","style","disabled","reload","error","console","log"],"mappings":"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"}