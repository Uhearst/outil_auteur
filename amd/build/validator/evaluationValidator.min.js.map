{"version":3,"file":"evaluationValidator.min.js","sources":["../../src/validator/evaluationValidator.js"],"sourcesContent":["import {validateIsEmbed} from \"./validatorUtils\";\nimport {addNotification} from \"../notificationHelper\";\n/**\n *\n */\nexport function validateEvaluationForm() {\n    document.getElementById('udeh-form').addEventListener(\"submit\", function(e) {\n        e.preventDefault();\n\n        let validObj = validateObjectives();\n        let validModules = validateModules();\n        if (!validObj || !validModules) {\n            return;\n        }\n        window.$('#udeh-form').submit();\n    });\n}\n\n/**\n * @param {Integer} length\n */\nexport function validateEvaluationDataForm(length = null) {\n    document.getElementById('udeh-form').addEventListener(\"submit\", function(e) {\n        e.preventDefault();\n\n        if (length !== null) {\n            let isGood = true;\n            for (let i = 0; i < length; i++) {\n                validateIsEmbed(i);\n            }\n            if (!isGood) {\n                return;\n            }\n        } else {\n            validateIsEmbed();\n        }\n\n        window.$('#udeh-form').submit();\n    });\n}\n\n/**\n *\n */\nfunction validateObjectives() {\n    let isValid = true;\n    let evaluations = document.querySelectorAll('[id^=\"row_course_evaluation_container_\"]');\n\n    let notCheckedEvaluationsId = [];\n    evaluations.forEach(function(evaluation, index) {\n        let hasChecked = false;\n        let learningObjContainer = document.getElementById('fitem_id_evaluation_learning_objectives_' + index);\n        let checkboxes = learningObjContainer.querySelectorAll('[id^=\"id_evaluation_learning_objectives_\"]');\n        checkboxes.forEach(checkbox => {\n            if (checkbox.checked) {\n                hasChecked = true;\n            }\n        });\n        if (!hasChecked) {\n            notCheckedEvaluationsId.push(index);\n        }\n    });\n\n    if (notCheckedEvaluationsId.length > 0) {\n        notCheckedEvaluationsId.forEach(notCheckedEvaluationId => {\n            let errorMsg = document.getElementById('error_msg_obj_' + notCheckedEvaluationId);\n            if (errorMsg === null) {\n                let span = document.createElement('span');\n                span.style.color = 'red';\n                span.id = 'error_msg_obj_' + notCheckedEvaluationId;\n                span.style.margin = '0 0 0 1rem';\n                span.innerHTML = '* Un objectif d\\'apprentissage est requis';\n                document.getElementById('course_evaluation_content_' + notCheckedEvaluationId).insertBefore(\n                    span, document.getElementById('fitem_id_evaluation_learning_objectives_' + notCheckedEvaluationId));\n            }\n        });\n        isValid = false;\n    }\n    if (!isValid) {\n        addNotification('Vous devez ajouter au moins un objectif d\\'apprentissage par évaluation', 2);\n    } else {\n        let errorMsgs = document.querySelectorAll('[id^=\"error_msg_obj_\"]');\n        errorMsgs.forEach(errorMsg => {\n            errorMsg.remove();\n        });\n    }\n    return isValid;\n}\n\n/**\n *\n */\nfunction validateModules() {\n    let isValid = true;\n    let selectedValues = [];\n    let moduleContainers = document.querySelectorAll('[id^=\"fitem_id_evaluation_module_\"]');\n\n    moduleContainers.forEach(function(moduleContainer) {\n        let select = moduleContainer.querySelector('.custom-select');\n        selectedValues.push((select.value));\n    });\n\n    selectedValues.forEach(function(selectedValue, index) {\n        let results = selectedValues.filter(val => val === selectedValue);\n        if (results.length > 1 && selectedValue !== \"0\") {\n            let errorMsg = document.getElementById('error_msg_module_' + index);\n            if (errorMsg === null) {\n                let span = document.createElement('span');\n                span.style.color = 'red';\n                span.id = 'error_msg_module_' + index;\n                span.style.margin = '0 0 0.5rem 1rem';\n                span.innerHTML = '* Le module doit être unique à chaque évaluation';\n                document.getElementById('course_evaluation_content_' + index).insertBefore(\n                    span, document.getElementById('fitem_id_evaluation_module_' + index));\n            }\n            isValid = false;\n        }\n    });\n    if(!isValid) {\n        addNotification('Le module doit être unique à chaque évaluation', 2);\n    }\n    else {\n        let errorMsgs = document.querySelectorAll('[id^=\"error_msg_module_\"]');\n        errorMsgs.forEach(errorMsg => {\n            errorMsg.remove();\n        });\n    }\n    return isValid;\n}\n\n"],"names":["length","document","getElementById","addEventListener","e","preventDefault","i","window","$","submit","validObj","isValid","evaluations","querySelectorAll","notCheckedEvaluationsId","forEach","evaluation","index","hasChecked","checkbox","checked","push","notCheckedEvaluationId","span","createElement","style","color","id","margin","innerHTML","insertBefore","errorMsg","remove","validateObjectives","validModules","selectedValues","moduleContainer","select","querySelector","value","selectedValue","filter","val","validateModules"],"mappings":"sRAqB2CA,8DAAS,KAChDC,SAASC,eAAe,aAAaC,iBAAiB,UAAU,SAASC,MACrEA,EAAEC,iBAEa,OAAXL,OAAiB,SAERM,EAAI,EAAGA,EAAIN,OAAQM,wCACRA,GAFP,4CAWjBC,OAAOC,EAAE,cAAcC,wDA/B3BR,SAASC,eAAe,aAAaC,iBAAiB,UAAU,SAASC,GACrEA,EAAEC,qBAEEK,wBAoCJC,SAAU,EACVC,YAAcX,SAASY,iBAAiB,4CAExCC,wBAA0B,GAC9BF,YAAYG,SAAQ,SAASC,WAAYC,WACjCC,YAAa,EACUjB,SAASC,eAAe,2CAA6Ce,OAC1DJ,iBAAiB,8CAC5CE,SAAQ,SAAAI,UACXA,SAASC,UACTF,YAAa,MAGhBA,YACDJ,wBAAwBO,KAAKJ,UAIjCH,wBAAwBd,OAAS,IACjCc,wBAAwBC,SAAQ,SAAAO,2BAEX,OADFrB,SAASC,eAAe,iBAAmBoB,wBACnC,KACfC,KAAOtB,SAASuB,cAAc,QAClCD,KAAKE,MAAMC,MAAQ,MACnBH,KAAKI,GAAK,iBAAmBL,uBAC7BC,KAAKE,MAAMG,OAAS,aACpBL,KAAKM,UAAY,2CACjB5B,SAASC,eAAe,6BAA+BoB,wBAAwBQ,aAC3EP,KAAMtB,SAASC,eAAe,2CAA6CoB,6BAGvFX,SAAU,MAETA,QAEE,CACaV,SAASY,iBAAiB,0BAChCE,SAAQ,SAAAgB,UACdA,SAASC,wDAJG,yEAA2E,UAOxFrB,QA7EYsB,GACXC,4BAmFJvB,SAAU,EACVwB,eAAiB,MACElC,SAASY,iBAAiB,uCAEhCE,SAAQ,SAASqB,qBAC1BC,OAASD,gBAAgBE,cAAc,kBAC3CH,eAAed,KAAMgB,OAAOE,UAGhCJ,eAAepB,SAAQ,SAASyB,cAAevB,UAC7BkB,eAAeM,QAAO,SAAAC,YAAOA,MAAQF,iBACvCxC,OAAS,GAAuB,MAAlBwC,cAAuB,IAE5B,OADFvC,SAASC,eAAe,oBAAsBe,OACtC,KACfM,KAAOtB,SAASuB,cAAc,QAClCD,KAAKE,MAAMC,MAAQ,MACnBH,KAAKI,GAAK,oBAAsBV,MAChCM,KAAKE,MAAMG,OAAS,kBACpBL,KAAKM,UAAY,mDACjB5B,SAASC,eAAe,6BAA+Be,OAAOa,aAC1DP,KAAMtB,SAASC,eAAe,8BAAgCe,QAEtEN,SAAU,MAGdA,QAGC,CACeV,SAASY,iBAAiB,6BAChCE,SAAQ,SAAAgB,UACdA,SAASC,wDALG,iDAAkD,UAQ/DrB,QArHgBgC,GACdjC,UAAawB,cAGlB3B,OAAOC,EAAE,cAAcC"}