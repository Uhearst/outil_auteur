define("format_udehauthoring/moduleHelper",["exports","./utils","./language/format_udehauthoring_fr"],(function(_exports,_utils,_format_udehauthoring_fr){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.fillFormModules=function(modules){modules.forEach((function(module,i){0===i?(waitWithInterval("id_section_title_0editable",0,module.title),waitWithInterval("id_section_title_0",1,module.title),waitWithInterval("id_section_question_0editable",0,module.question),waitWithInterval("id_section_question_0",1,module.question),waitWithInterval("id_section_description_0editable",0,module.description),waitWithInterval("id_section_description_0",1,module.description)):(null===document.getElementById("id_section_title_"+i)&&addModule(!1),document.getElementById("id_section_title_"+i).innerHTML=module.title,document.getElementById("id_section_question_"+i).innerHTML=module.question,document.getElementById("id_section_description_"+i).innerHTML=module.description);!function(id,counter){var input=document.createElement("input");input.setAttribute("name","section_"+counter+"_id_value"),input.setAttribute("value",id),input.hidden=!0;var element=document.getElementById("fitem_id_section_title_"+counter);element.parentNode.insertBefore(input,element)}(module.id,i)})),(0,_utils.prepareActionButton)([{type:0,id:"module_0"},{type:1,id:"module"}]),disableModuleDeleteButton(),(0,_utils.prepareAccordions)("row_course_module_container_")},_exports.initModules=function(){var formContainer=document.getElementById("form_container"),addButton=document.querySelector("#id_add_module");formContainer.addEventListener("click",(function(event){if("BUTTON"===event.target.nodeName||"I"===event.target.nodeName&&event.target.parentNode&&"BUTTON"===event.target.parentNode.nodeName){var index,module,element=null;if((element="I"===event.target.nodeName?event.target.parentNode:event.target)&&element.id.includes("module")&&!1===element.hidden)if(element.id.includes("remove")){var id=element.id.substring(element.id.lastIndexOf("_")+1);index=id,module=document.getElementById("row_course_module_container_"+index),(0,_utils.removeTinyMce)("id_section_title_"+index),(0,_utils.removeTinyMce)("id_section_question_"+index),(0,_utils.removeTinyMce)("id_section_description_"+index),module.remove(),function(index){document.querySelectorAll('[id^="row_course_module_container_"]').forEach((function(module){if(parseInt(module.id.substring(module.id.lastIndexOf("_")+1))>parseInt(index)){var currentIndex=parseInt(module.id.substring(module.id.lastIndexOf("_")+1));module.setAttribute("id","row_course_module_container_"+(currentIndex-1));var header=module.querySelector(".accordion-header");header.setAttribute("id","course_module_header_"+(currentIndex-1)),header.firstElementChild.setAttribute("href","#collapse_module_"+(currentIndex-1)),header.firstElementChild.setAttribute("aria-controls","collapse_module_"+(currentIndex-1)),header.firstElementChild.innerHTML=_format_udehauthoring_fr.dictionnary.module+currentIndex;var collapsible=module.querySelector(".collapse");collapsible.setAttribute("id","collapse_module_"+(currentIndex-1)),collapsible.firstElementChild.setAttribute("id","course_module_content_"+(currentIndex-1)),updateEditorAndLabel(module,currentIndex,"title","superscript subscript | undo redo"),updateEditorAndLabel(module,currentIndex,"question","superscript subscript | undo redo"),updateEditorAndLabel(module,currentIndex,"description","bold italic | numlist bullist | underline strikethrough superscript subscript | undo redo")}}))}(index),updateAddModuleButton(),disableModuleDeleteButton(),document.querySelectorAll('[id^="fitem_id_remove_module_"]').forEach((function(button,index){button.setAttribute("id","fitem_id_remove_module_"+index);var buttonElm=button.querySelector('[type="button"]');buttonElm.setAttribute("name","remove_module_"+index),buttonElm.setAttribute("id","id_remove_module_"+index)})),counterModules-=1,event.stopImmediatePropagation()}}})),addButton.addEventListener("click",(function(event){if("BUTTON"===event.target.nodeName||"I"===event.target.nodeName&&event.target.parentNode&&"BUTTON"===event.target.parentNode.nodeName){event.stopImmediatePropagation();var element=null;(element="I"===event.target.nodeName?event.target.parentNode:event.target)&&element.id.includes("module")&&!1===element.hidden&&addModule(!0)}}));var addingButtonsContainer=document.querySelectorAll("[class='col-md-9 form-inline align-items-start felement']");addingButtonsContainer&&addingButtonsContainer.forEach((function(addingButtonContainer){"button"===addingButtonContainer.dataset.fieldtype&&(addingButtonContainer.removeAttribute("class"),addingButtonContainer.childNodes.forEach((function(child){child.type&&"button"===child.type&&child.classList.remove("btn-secondary")})))}));var addingButtons=document.querySelectorAll("[class*='add_action_button']");addingButtons&&addingButtons.forEach((function(addingButton){addingButton.childNodes.forEach((function(child){child.removeAttribute("class")}))}));disableModuleDeleteButton(),(0,_utils.prepareAccordions)("row_course_module_container_")};var counterModules=0;function addModule(fromBtnClick){var index,titleContainer,questionContainer,descriptionContainer,titleToolTip,questionToolTip,descriptionToolTip,x=function(){counterModules+=1;var rowModuleContainer=document.createElement("div"),colModuleContainer=document.createElement("div"),colButtonContainer=document.createElement("div");rowModuleContainer.setAttribute("class","row row-container mb-3"),rowModuleContainer.setAttribute("id","row_course_module_container_"+counterModules),colModuleContainer.setAttribute("class","col-11 accordion-container card"),colButtonContainer.setAttribute("class","col-1 remove_module_action_button");var header=(headerContainer=document.createElement("div"),linkForCollapseDiv=document.createElement("a"),headerContainer.setAttribute("class","card-header accordion-header"),headerContainer.setAttribute("id","course_module_header_"+counterModules),linkForCollapseDiv.setAttribute("data-toggle","collapse"),linkForCollapseDiv.setAttribute("href","#collapse_module_"+counterModules),linkForCollapseDiv.setAttribute("role","button"),linkForCollapseDiv.setAttribute("aria-expanded","false"),linkForCollapseDiv.setAttribute("aria-controls","collapse_module_"+counterModules),linkForCollapseDiv.setAttribute("class","collapsed"),linkForCollapseDiv.innerHTML=_format_udehauthoring_fr.dictionnary.module+(counterModules+1),headerContainer.appendChild(linkForCollapseDiv),headerContainer),content=function(){var contentContainer=document.createElement("div"),collapseDiv=document.createElement("div");collapseDiv.setAttribute("class","collapse"),collapseDiv.setAttribute("id","collapse_module_"+counterModules),collapseDiv.setAttribute("data-parent","#displayable-form-sections-container"),contentContainer.setAttribute("class","card-body accordion-content"),contentContainer.setAttribute("id","course_module_content_"+counterModules);var title=buildEditorContainer("section_title","Titre du module"),question=buildEditorContainer("section_question",_format_udehauthoring_fr.dictionnary.moduleQuestion),description=buildEditorContainer("section_description",_format_udehauthoring_fr.dictionnary.moduleDescription);return contentContainer.appendChild(title),contentContainer.appendChild(question),contentContainer.appendChild(description),collapseDiv.appendChild(contentContainer),collapseDiv}();var headerContainer,linkForCollapseDiv;colModuleContainer.appendChild(header),colModuleContainer.appendChild(content);var button=function(){var rowModuleContainer=document.createElement("div"),buttonContainer=document.createElement("div"),buttonElement=document.createElement("button"),icon=document.createElement("i");return rowModuleContainer.setAttribute("id","fitem_id_remove_module_"+counterModules),buttonContainer.setAttribute("data-fieldtype","button"),buttonElement.setAttribute("class","btn ml-0"),buttonElement.setAttribute("name","remove_module_"+counterModules),buttonElement.setAttribute("id","id_remove_module_"+counterModules),buttonElement.setAttribute("type","button"),icon.setAttribute("class","remove-button-js fa fa-minus-circle fa-2x"),buttonElement.appendChild(icon),buttonContainer.appendChild(buttonElement),rowModuleContainer.appendChild(buttonContainer),rowModuleContainer}();return colButtonContainer.appendChild(button),rowModuleContainer.appendChild(colModuleContainer),rowModuleContainer.appendChild(colButtonContainer),rowModuleContainer}();document.getElementById("displayable-form-sections-container").insertBefore(x,document.getElementById("section-add-container")),updateAddModuleButton(),disableModuleDeleteButton(),(0,_utils.initTinyMce)("id_section_title_"+counterModules,"superscript subscript | undo redo"),(0,_utils.initTinyMce)("id_section_question_"+counterModules,["formatselect bold italic | numlist bullist indent outdent | link unlink | emoticons image ","underline strikethrough superscript subscript | alignleft aligncenter alignright | charmap table removeformat | undo redo "]),(0,_utils.initTinyMce)("id_section_description_"+counterModules,["formatselect bold italic | numlist bullist indent outdent | link unlink | emoticons image ","underline strikethrough superscript subscript | alignleft aligncenter alignright | charmap table removeformat | undo redo "]),index=counterModules,titleContainer=document.getElementById("fitem_id_section_title_0"),questionContainer=document.getElementById("fitem_id_section_question_0"),descriptionContainer=document.getElementById("fitem_id_section_description_0"),titleToolTip=titleContainer.firstElementChild.children[1],questionToolTip=questionContainer.firstElementChild.children[1],descriptionToolTip=descriptionContainer.firstElementChild.children[1],document.getElementById("fitem_id_section_title_"+index).firstElementChild.appendChild(titleToolTip.cloneNode(!0)),document.getElementById("fitem_id_section_question_"+index).firstElementChild.appendChild(questionToolTip.cloneNode(!0)),document.getElementById("fitem_id_section_description_"+index).firstElementChild.appendChild(descriptionToolTip.cloneNode(!0)),fromBtnClick&&(0,_utils.handleNewAccordionElement)(x)}function buildEditorContainer(id,labelText){var fieldContainer=document.createElement("div"),labelContainer=document.createElement("div"),label=document.createElement("label"),editorContainer=document.createElement("div");fieldContainer.setAttribute("class","form-group row  fitem   tiny-editor"),fieldContainer.setAttribute("id","fitem_id_"+id+"_"+counterModules),labelContainer.setAttribute("class","col-md-3 col-form-label d-flex pb-0 pr-md-0"),label.setAttribute("class","d-inline word-break"),label.setAttribute("for","id_"+id+"_"+counterModules),label.innerHTML=labelText,editorContainer.setAttribute("class","col-md-9 align-items-start felement"),editorContainer.setAttribute("data-fieldtype","editor");var target,moduleIndex,inputContainerDiv,editor=(target=id,moduleIndex=counterModules,(inputContainerDiv=document.createElement("textarea")).setAttribute("class","custom-editor"),inputContainerDiv.setAttribute("id","id_"+target+"_"+moduleIndex),inputContainerDiv.setAttribute("name",target+"_"+moduleIndex),inputContainerDiv);return editorContainer.appendChild(editor),labelContainer.appendChild(label),fieldContainer.appendChild(labelContainer),fieldContainer.appendChild(editorContainer),fieldContainer}function disableModuleDeleteButton(){1===document.querySelectorAll('[id^="row_course_module_container_"]').length?document.getElementById("id_remove_module_0").hidden=!0:document.querySelectorAll('[id^="id_remove_module"]').forEach((function(button){button.hidden=!1}))}function updateAddModuleButton(){var x=document.querySelectorAll('[id^="row_course_module_container_"]');document.getElementById("section-add-container").querySelector(".add-text").innerHTML=_format_udehauthoring_fr.dictionnary.module+(x.length+1)}function updateEditorAndLabel(module,currentIndex,element,toolbarOptions){var titleContainer=module.querySelector('[id^="fitem_id_section_'+element+'_"]');titleContainer.setAttribute("id","fitem_id_section_"+element+"_"+(currentIndex-1)),titleContainer.querySelector('[for^="id_section_'+element+'_"]').setAttribute("for","id_section_"+element+"_"+(currentIndex-1)),(0,_utils.removeTinyMce)("id_section_"+element+"_"+currentIndex);var editorTitle=titleContainer.querySelector('[id^="id_section_'+element+'_"]');editorTitle.setAttribute("id","id_section_"+element+"_"+(currentIndex-1)),editorTitle.setAttribute("name","section_"+element+"_"+(currentIndex-1)),(0,_utils.initTinyMce)("id_section_"+element+"_"+(currentIndex-1),toolbarOptions)}function waitWithInterval(id,type,toAppend){var element=null,timereditable=setInterval((function(){null!==(element=document.getElementById(id))&&(0===type?element.innerHTML=toAppend:element.value=toAppend,clearInterval(timereditable))}),100)}}));

//# sourceMappingURL=moduleHelper.min.js.map